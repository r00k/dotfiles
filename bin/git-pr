#! /usr/bin/env ruby

issue= ARGV.shift
current_branch = `git rev-parse --abbrev-ref HEAD`
default_branch = ENV.fetch("DEFAULT_BRANCH", "master")
origin_url = `git config --get remote.origin.url`
if origin_url.start_with?("git")
  repo = origin_url.split(':')[1].split('.')[0]
else
  repo = origin_url.sub('https://github.com/', '').split('.')[0]
end

command = "gh pull-request"
command = command + " -i #{issue}" if issue
command = command + " -b #{repo}:#{default_branch} -h #{repo}:#{current_branch}"
system command
